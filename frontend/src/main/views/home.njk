{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}
{% from "govuk/components/button/macro.njk" import govukButton %}


{% extends "template.njk" %}

{% block content %}
  <h1 class="govuk-heading-xl">HMCTS Task Tracker</h1>
  <h2 class="govuk-heading-m">Outstanding Tasks</h2>
  {% if tasks|length %}

    {% set tableRows = [] %}
    {% for task in tasks %}
        {% set editLink = '<a href="{{ task.id }}">Edit</a>' %}
        {% set tableRows = (tableRows.push([
            { text: task.title },
            { text: task.dueDate},
            { text: task.status},
            { html: ("<a href='task/" + task.id + "'>Edit</a>")}
        ]), tableRows) %}
    {% endfor %}

    {{ govukTable({
      caption: "Tasks due soon",
      captionClasses: "govuk-table__caption--m",
      firstCellIsHeader: true,
      head: [
        {
          text: "Task"
        },
        {
          text: "Due Date"
        },
        {
          text: "Status"
        },
        {
          text: ""
        }
      ],
      rows: tableRows
    }) }}



  {% else %}

    {{ govukWarningText({
      text: "No outstanding tasks!",
      iconFallbackText: "Warning"
    }) }}

  {% endif %}

  {{ govukButton({
    text: "Add Task",
    href: "task/add"
  }) }}

{% endblock %}
